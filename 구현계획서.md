📅 급식 알림 PWA 웹앱 구현 계획서

1. 목표 및 개요
서비스명: (가칭) 오늘의 급식 알리미

주요 기능: 매일 아침 7시 30분, 나이스 API를 통해 급식 정보를 가져와 등록된 500명에게 푸시 알림 전송.

대상 플랫폼: 안드로이드(Chrome), iOS(Safari - iOS 16.4+ 지원).

2. 시스템 아키텍처
프론트엔드 (PWA): 사용자가 접속하여 '홈 화면에 추가'하고 알림 권한을 승인하는 웹페이지.

백엔드 (Firebase Cloud Functions): 매일 정해진 시간에 작동하는 스케줄러 서버.

데이터베이스 (Firestore): 사용자의 기기별 알림 토큰(Token) 저장.

외부 연동 (NEIS API): 교육청으로부터 급식 데이터를 수집.

3. 단계별 구현 상세
1단계: 파이어베이스 프로젝트 설정
Hosting: 웹사이트 파일을 배포할 공간 생성.

Firestore: 알림 구독 정보를 담을 tokens 컬렉션 생성.

Cloud Messaging (FCM): 웹 푸시 인증서(VAPID 키) 발급.

요금제: Blaze(종량제)로 전환 필수 (나이스 API 같은 외부 네트워크 호출을 위해 필요하지만, 500명 규모는 무료 할당량 내에서 거의 0원 청구).

2단계: 나이스 급식 API 연동 (Node.js)
나이스 교육정보 개방 포털에서 인증키 발급.

학교 코드와 교육청 코드를 파라미터로 넣어 당일 식단 데이터를 가져오는 로직 작성.

3단계: 백엔드 스케줄러 구축 (Cloud Functions)
functions.pubsub.schedule('30 7 * * *') 구문을 사용하여 매일 오전 7:30에 실행되도록 설정.

로직 흐름: 나이스 데이터 호출 → Firestore에서 500명의 토큰 조회 → FCM을 통해 대량 발송.

4단계: PWA 프론트엔드 및 알림 승인
Manifest.json: 앱 아이콘, 이름, 배경색 등 앱 설정 정의.

Service Worker: 브라우저가 닫혀 있어도 알림을 수신하도록 처리.

권한 요청: 사용자가 웹사이트에서 "급식 알림 받기" 버튼을 누르면 브라우저 권한 팝업 호출.